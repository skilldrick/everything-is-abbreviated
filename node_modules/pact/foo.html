<h1>Pact</h1>
<p>A collection of <a href="http://vowsjs.org/">Vows</a> macros for easy HTTP server testing.</p>
<p>Tastes great with <a href="http://expressjs.com">Express</a> and <a href="http://senchalabs.github.com/connect/">Connect</a>.</p>
<p>Works with <a href="http://nodejs.org/">Node.js</a> v0.2.5 and later.</p>
<h2>Documentation</h2>
<p><a href="http://reid.github.com/pact/">http://reid.github.com/pact/</a></p>
<h2>Installation</h2>
<pre><code>npm i pact
</code></pre>
<h2>Run tests</h2>
<p>Requires <a href="http://vowsjs.org/">Vows</a>.</p>
<pre><code>make test
</code></pre>
<h2>Example</h2>
<pre><code>// Pact works with http.Server instances.
// This includes express.Server, connect.Server, etc.
// This method returns a new express.Server:
var createServer = require("../lib/app").createServer;

require("vows").describe("HTTP Server").addBatch({
    "A server in development" : {
        // Start a server for testing with httpify
        // Give it a new http.Server
        topic : httpify(createServer()),
        "when /foo is requested" : {
            topic : request(), // knows the URL from context name
            "should fail" : code(400) // check status code
        }
        "when /foo?bar=baz is requested" : {
            topic : request(),
            "should succeed" : code(200),
            "should return response time header" : function (topic) {
                // header names are lowercased for easy testing
                assert.include(topic.headers, "x-response-time");
            },
            "should be correct size" : function (topic) {
                // response is available as topic.body
                assert.equal(topic.body.length, 11);
            }
        },
        "when making a bogus request" : {
            // you can always specify your own URL
            // POST requests work as well
            topic : request({
                url : "/bogus",
                method : "POST",
                body : "quux=0"
            }),
            "should fail" : code(404)
        }
    },
    "A server in production" : {
        topic : function () {
            // Example: wrap httpify for testing
            // with a new environment
            var oldEnv = process.env.NODE_ENV;
            process.env.NODE_ENV = "production";
            var server = app.createServer();
            httpify(server).apply(this);
            process.env.NODE_ENV = oldEnv;
        },
        "when / is requested" : {
            topic : request(),
            "should fail" : code(404)
        }
    }
}).export(module);
</code></pre>
<h2>About</h2>
<p>Authored by <a href="http://github.com/reid">Reid Burke</a>, copyright Yahoo! Inc., and provided under the BSD license. See LICENSE file.</p>
<h2>History</h2>
<p>Pact is used at Yahoo! for testing Node.js servers. It's based on the embedded Vows macros from the YUI Labs <a href="http://github.com/yui/yeti">Yeti</a> project.</p>
<h2>Bugs</h2>
<p>Submit bugs and pull requests to <a href="http://github.com/reid/pact">Pact on GitHub</a>.</p>